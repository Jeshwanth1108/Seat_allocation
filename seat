i want to automate the process of college seats allocation according to the rank of students got in an Enterence test, here actual process is i have three csv file one consists of student_details, one consists of their choice of intreseted colleges with prefernce wise, and the other contains college details and seats available in that, the process is first select unique id and his caste from students file according to the rank, them search that id in prefernce file and fetch college id opted by that person according to prefernce order, then search collegeId in seats file then check whether that college have available seats for that person caste, if yes then allocate seat for him, and decrese the value of his caste in the seats file and increment total no.of students admitted by one, if no then go back to prefernce table fetch next collegeId selected according to prefernce, and so same process, 
repeat the process upto seat allocated for that person, if no seats available in his prefernce list then return "Try again in next Phase.", if seat alloted successfully them print the details (UniqueID, PrefenceNo, Gender, Caste) in seperate spreedsheet. 

I need a python code for this statement, explain me in details
